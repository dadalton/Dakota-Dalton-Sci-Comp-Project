(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8579,        227]
NotebookOptionsPosition[      7994,        205]
NotebookOutlinePosition[      8340,        220]
CellTagsIndexPosition[      8297,        217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This program solves the Helmholtz equation in 2 dimensions with a given \
domain and boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.7013900736503005`*^9, 3.7013901063186593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ax", " ", "=", " ", 
   RowBox[{"-", "Pi"}]}], ";", " ", 
  RowBox[{"ay", " ", "=", " ", "ax"}], ";", " ", 
  RowBox[{"bx", " ", "=", " ", "Pi"}], ";", " ", 
  RowBox[{"by", " ", "=", " ", "bx"}], ";"}]], "Input",
 CellChangeTimes->{{3.70139023596526*^9, 3.7013902668079014`*^9}, {
  3.70139068218814*^9, 3.70139068884396*^9}, {3.701518715911846*^9, 
  3.701518721282411*^9}, {3.7015294496052904`*^9, 3.7015294621610923`*^9}, {
  3.7015295018867426`*^9, 3.701529508202557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.701518003346651*^9, 3.7015180081088924`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gb", "[", "x", "]"}], "=", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"Pi", " ", "-", " ", "x"}], ")"}], "2"], " ", "*", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"Pi", " ", "x"}], "bx"], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7013904841896086`*^9, 3.701390567450279*^9}, {
   3.7013906719542446`*^9, 3.701390672191081*^9}, {3.7013909155994487`*^9, 
   3.7013909229885263`*^9}, {3.7015183121450787`*^9, 3.7015183333667974`*^9}, 
   3.701518377984593*^9, {3.701518436924494*^9, 3.701518485695516*^9}, 
   3.701519445910248*^9, 3.7015201315374727`*^9, {3.7015220842990637`*^9, 
   3.701522084719778*^9}, {3.7015221198900814`*^9, 3.7015221306013527`*^9}, 
   3.7015234333663206`*^9, 3.701524099813674*^9, 3.701524252422686*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fb", "[", "x", "]"}], "=", " ", 
   RowBox[{"x", " ", "*", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"bx", " ", "-", " ", "x"}], ")"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7013905719526873`*^9, 3.7013906027259903`*^9}, {
  3.7013910793014917`*^9, 3.7013910802506933`*^9}, {3.7015240866997824`*^9, 
  3.7015240940989947`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"\[Pi]", " ", 
      FractionBox[
       RowBox[{"x", " ", "-", " ", "ax"}], 
       RowBox[{"bx", " ", "-", " ", "ax"}]]}], "]"}], " ", "*", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      FractionBox["\[Pi]", "2"], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", 
         FractionBox[
          RowBox[{"y", " ", "-", " ", "ay"}], 
          RowBox[{"by", " ", "-", " ", "ay"}]]}], "+", "1"}], ")"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.70139064817387*^9, 3.701390663629527*^9}, {
  3.701390713836195*^9, 3.701390802742361*^9}, {3.701391084834038*^9, 
  3.701391103392833*^9}, {3.70152213458998*^9, 3.7015221398184433`*^9}, {
  3.7015222181657486`*^9, 3.7015222288960204`*^9}, {3.7015242392961187`*^9, 
  3.701524247621085*^9}, {3.7015242944244747`*^9, 3.7015242997142334`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xax", "[", "y", "]"}], "=", " ", 
   RowBox[{
    RowBox[{"gb", "[", "ax", "]"}], " ", "+", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"y", " ", "-", " ", "ay"}], 
      RowBox[{"by", " ", "-", " ", "ay"}]], "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"fb", "[", "ax", "]"}], "-", 
       RowBox[{"gb", "[", "ax", "]"}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7013908756722183`*^9, 3.70139091157943*^9}, {
  3.7013911617156143`*^9, 3.701391247949851*^9}, {3.7015242593905706`*^9, 
  3.7015242642050548`*^9}, {3.7015279929104652`*^9, 3.701527995259615*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"helmholtz", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Laplacian", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"\[CapitalLambda]", " ", 
      RowBox[{"u", " ", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], " ", "\[Equal]", "  ", 
    RowBox[{"F", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7014309144974155`*^9, 3.701430997103636*^9}, {
   3.7014310777708817`*^9, 3.701431089371785*^9}, {3.701431179824674*^9, 
   3.7014311935490227`*^9}, {3.7015134743633986`*^9, 
   3.7015134748831573`*^9}, {3.7015138486534524`*^9, 3.7015138546284895`*^9}, 
   3.701513924925747*^9, 3.7015243219808073`*^9, {3.7015281774402957`*^9, 
   3.701528178245123*^9}, {3.7015282407898846`*^9, 3.7015282416842265`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "ay"}], "]"}], " ", "\[Equal]", " ", 
        RowBox[{"gb", "[", "x", "]"}]}], ",", " ", "True"}], "]"}], ",", " ", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "by"}], "]"}], "\[Equal]", " ", 
        RowBox[{"fb", "[", "x", "]"}]}], ",", "True"}], "]"}], " ", ",", " ", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"ax", ",", "y"}], "]"}], " ", "\[Equal]", " ", 
        RowBox[{"xax", "[", "y", "]"}]}], ",", "True"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"bx", ",", "y"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"NeumannValue", "[", 
       RowBox[{"0", ",", "True"}], "]"}]}]}], " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7015141252813177`*^9, 3.701514143822852*^9}, {
   3.7015149544468203`*^9, 3.701515028040429*^9}, {3.7015165721220655`*^9, 
   3.701516616051371*^9}, 3.7015167877068605`*^9, {3.701524952950301*^9, 
   3.7015249687639313`*^9}, {3.701527365926096*^9, 3.7015273683868713`*^9}, {
   3.701527434146839*^9, 3.701527468826977*^9}, {3.701527877366824*^9, 
   3.701527956670087*^9}, {3.7015282034286957`*^9, 3.7015282195169115`*^9}, 
   3.701528358300782*^9, {3.7015286736657124`*^9, 3.701528767487424*^9}, {
   3.701529299498914*^9, 3.7015293003099985`*^9}, {3.7015301022238393`*^9, 
   3.701530204018007*^9}, {3.701530261225721*^9, 3.7015302863758507`*^9}, {
   3.7015303745612173`*^9, 3.701530379504233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"helmholtz", ",", "bc"}], "}"}], ",", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "ax", ",", "bx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "ay", ",", "by"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7015168404291134`*^9, 3.7015168731445827`*^9}, 
   3.7015188652842307`*^9, {3.7015245135448256`*^9, 3.701524514938426*^9}, 
   3.7015249829099855`*^9, {3.701525522373803*^9, 3.701525529053543*^9}, 
   3.7015273030779347`*^9, {3.701528018891572*^9, 3.701528038788045*^9}, 
   3.7015287921575828`*^9, {3.7015293478452635`*^9, 3.7015294068653636`*^9}, {
   3.7015295201799335`*^9, 3.7015295290642805`*^9}, {3.7015295874427943`*^9, 
   3.701529616472109*^9}, {3.7015303207231674`*^9, 3.70153034560019*^9}}]
},
WindowSize->{681, 676},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 4, 49, "Text"],
Cell[760, 26, 512, 10, 30, "Input"],
Cell[1275, 38, 160, 3, 30, "Input"],
Cell[1438, 43, 831, 17, 50, "Input"],
Cell[2272, 62, 402, 10, 30, "Input"],
Cell[2677, 74, 990, 25, 51, "Input"],
Cell[3670, 101, 642, 16, 50, "Input"],
Cell[4315, 119, 937, 21, 30, "Input"],
Cell[5255, 142, 1744, 37, 88, "Input"],
Cell[7002, 181, 988, 22, 30, "Input"]
}
]
*)

