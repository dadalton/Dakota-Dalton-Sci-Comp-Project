%testing use of pdetool to verify helmholtz

helmholtzmodel = createpde();
square = [3; 4; -pi; pi; pi; -pi; -pi; -pi; pi; pi];
domain = decsg(square);
pdegplot(domain, 'EdgeLabels', 'on')
xlim([-4,4])
ylim([-4,4])

gb = @(x) (bx-x).^2 .* cos((pi*x)/bx); %boundary condition for y
fb = @(x) x .* (bx - x).^2;
xax = @(y) gb(1) + (y-ay)/(by-ay) * (fb(1)-gb(1));

applyBoundaryCondition(helmholtzmodel, 'dirichlet', 'Edge', 1, 'y', gb)
applyBoundaryCondition(helmholtzmodel, 'neumann', 'Edge', 2)
applyBoundaryCondition(helmholtzmodel, 'dirichlet', 'Edge', 3, 'y', fb)
applyBoundaryCondition(helmholtzmodel, 'dirichlet', 'Edge', 4, 'x', xax)

specifyCoefficients(helmholtzmodel, 'm', 0,...
                                    'd', 0,...
                                    'c', -1,...
                                    'a', 1, 'f', );  

% F = sin(pi * (x - ax)/(bx - ax)) ... %applied force
%     .* cos((pi/2)*(2*(y - ay)/(by - ay) + 1));